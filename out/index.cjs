"use strict";var w=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var U=(t,e)=>{for(var n in e)w(t,n,{get:e[n],enumerable:!0})},H=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of L(e))!P.call(t,r)&&r!==n&&w(t,r,{get:()=>e[r],enumerable:!(i=O(e,r))||i.enumerable});return t};var $=t=>H(w({},"__esModule",{value:!0}),t);var X={};U(X,{app:()=>A,component:()=>G,computed:()=>W,hasWindow:()=>Q,mapper:()=>j,ref:()=>J,render:()=>_,state:()=>B,store:()=>z,valueOf:()=>K});module.exports=$(X);var T=()=>{let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=t.length;for(let i=0;i<10;i++)e+=t.charAt(Math.floor(Math.random()*n));return e},F=T(),v=t=>{F=t};var k=t=>t.map(e=>JSON.stringify(Object.hasOwn(e,"get")&&e.get())).join("");var g=t=>{let e="",n=!1,i={},r=o=>{},d=()=>{let o=document.querySelector(`[data-nice-id="${e}"]`);!o||n||(n=!0,setTimeout(()=>{let a=r(e);a&&o.replaceWith(a.children[0]),n=!1},0))};return o=>(e=T(),v(e),i=o??{},r=t(i),{id:e,type:"component",properties:o,render:r,markDirty:d})};var A=(t,e)=>{let n=g(t)();if(e&&typeof window<"u"){let i=e?document.querySelector(e):void 0;if(!i)throw new Error(`Failed to attach - Element "${e}" not found in the DOM.`);n.markDirty=()=>{let r=n.render(T());if(r){for(;i.firstChild;)i.removeChild(i.firstChild);window?Array.from(r.hydrate().children).forEach(d=>{i.appendChild(d)}):i.innerHTML=r.html}},n.markDirty()}else return{html:n.render("nice-app-root").html,id:"nice-app-root",hydrate:i=>{let r=document.querySelector(`#${i}`);if(!r)throw new Error(`Failed to attach - Element "${e}" not found in the DOM.`);n.markDirty=()=>{let d=n.render(T());if(d){for(;r.firstChild;)r.removeChild(r.firstChild);window?Array.from(d.hydrate().children).forEach(c=>{r.appendChild(c)}):r.innerHTML=d.html}},n.markDirty()}}};var R=(t,...e)=>r=>{let d=`<!-- ${r} BEGIN -->`,c=`<!-- ${r} END -->`,o="",a={},l={};return t.forEach((p,m)=>{let s=e[m];if(o+=p,s===void 0)return;let f=Math.random().toString(36).substring(7);if(typeof s!="object"){o+=s;return}switch(s.type){case"component":o+=f,a[f]=s.render(s.id);break;case"state":o+=f,l[f]=s;break}}),Object.keys(a).forEach(p=>{o=o.replace(p,a[p].html.replace(/(<.+)( )/,`$1 data-reattach-child="${p}" `))}),Object.keys(l).forEach(p=>{let m=o.split(p)[0],s=q(m),f=l[p].get(),h=f;if(f)if(typeof f=="object"&&f.type==="component"){let y=f;h=y.render(y.id).html}else Array.isArray(f)&&(h=f.map(y=>{if(typeof y=="object"&&y.type==="component"){let u=y;return u.render(u.id).html}else return y}).join(""));let b=s?`state-${p}`:`<!-- @ --><span data-reattach-state="${p}" data-reattach-extras="${!!f}"></span>${h}<!-- # -->`;o=o.replace(p,b)}),{html:o,hydrate:()=>{let p=V(o);return p.children[0].setAttribute("data-nice-id",r),Object.keys(l).forEach(m=>{p.querySelectorAll(`[data-reattach-state="${m}"]`).forEach(s=>{s.getAttribute("data-reattach-extras")==="true"&&s.nextSibling?.remove();let h=l[m].get();l[m].markers.push([s.previousSibling,s.nextSibling]),E(h,s.previousSibling,s.nextSibling)})}),Object.keys(a).forEach(m=>{p.querySelectorAll(`[data-reattach-child="${m}"]`).forEach(s=>{s.replaceWith(a[m].hydrate().children[0])})}),p.querySelectorAll("*").forEach(m=>{Array.from(m.attributes).forEach(s=>{let f=s.name.startsWith("on-"),h=s.name.startsWith("set-"),b=s.name==="ref",y=s.value.match(/state-(.+)/);if(y){let u=l[y[1]];if(!u)return;u.attributes[s.name]||(u.attributes[s.name]=[]),f?(m.removeAttribute(s.name),m.addEventListener(s.name.slice(3),C=>u.set(C))):h?(m.removeAttribute(s.name),u.listen(C=>{m[s.name.slice(4)]=C}),m[s.name.slice(4)]=u.get()):b?(m.removeAttribute(s.name),u.set(m)):(u.attributes[s.name].push(m),m.setAttribute(s.name,u.get()??""))}})}),p}}},E=(t,e,n)=>{let i=[],r=e.nextSibling;for(;r!==n;)i.push(r),r=r?.nextSibling;if(t&&typeof t=="object"&&t.type==="component"){let d=t,c=d.render(d.id);i.forEach(o=>o.remove()),c&&Array.from(c.hydrate().children).reverse().forEach(o=>e.after(o))}else{let c=(Array.isArray(t)?t:[t]).map(o=>{if(typeof o=="object"&&o.type==="component"){let a=o;return a.render(a.id).hydrate()}else return o});i.forEach(o=>o.remove()),c.reverse().forEach(o=>{if(o instanceof HTMLElement)Array.from(o.children).reverse().forEach(a=>e.after(a));else{let a=document.createTextNode(o);e.after(a)}})}},V=t=>{let e=document.createElement("div");return e.innerHTML=t,e},q=t=>{let e=/.+\b(.+)="?$/gm,n,i=[];for(;(n=e.exec(t))!==null;)n.index===e.lastIndex&&e.lastIndex++,n.forEach(r=>{i.push(r)});if(i.length===2)return i[1]};var N=t=>{let e=t,n=T(),i=[],r=[],d=[],c={};return{id:n,type:"state",get:()=>e,set:o=>{let a=e;typeof t=="function"?a=o(e):a=o,a!==e&&(e=a,i.forEach(l=>l(a)),Object.entries(c).forEach(([l,x])=>{x.forEach(p=>{p.setAttribute(l,a??"")})}),d.forEach(([l,x])=>{E(e,l,x)}))},listen:o=>i.push(o),textNodes:r,markers:d,attributes:c}},S=(t,e)=>{let n=N(void 0),i=void 0,r=(e??[]).map(c=>c&&typeof c=="object"&&Object.hasOwn(c,"listen")?c:!1).filter(Boolean),d=c=>{let o=!!c&&!e,a=t(c),l=k(r);a!==n.get()&&l!==i&&!o&&n.set(a)};return e?(r.forEach(c=>c.listen(d)),d()):n.listen(d),n},I=t=>S(t||(()=>{}));var D=t=>{let e=Object.entries(t).reduce((n,[i,r])=>(n[i]=N(r),n),{});return[n=>e[n]]};var j=(t,e)=>{let n=[];return typeof t=="number"?n=Array.from({length:t},(i,r)=>r+1):typeof t=="object"?n=Array.from(Object.entries(t)):Array.isArray(t)&&(n=t),n.map((i,r)=>e(i,r))},M=t=>typeof t=="object"&&Object.hasOwn(t,"get")?t.get():t;var B=N,W=S,_=R,G=g,J=I,z=D,K=M,Q=typeof window<"u";
