"use strict";var w=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var q=Object.prototype.hasOwnProperty;var W=(t,e)=>{for(var r in e)w(t,r,{get:e[r],enumerable:!0})},B=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of V(e))!q.call(t,o)&&o!==r&&w(t,o,{get:()=>e[o],enumerable:!(i=F(e,o))||i.enumerable});return t};var K=t=>B(w({},"__esModule",{value:!0}),t);var te={};W(te,{app:()=>j,component:()=>Q,computed:()=>J,hasWindow:()=>v,mapper:()=>U,ref:()=>X,render:()=>Z,state:()=>G,store:()=>Y,styler:()=>P,valueOf:()=>ee});module.exports=K(te);var N=()=>{let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",r=t.length;for(let i=0;i<10;i++)e+=t.charAt(Math.floor(Math.random()*r));return e},_=N(),R=t=>{_=t};var I=t=>t.map(e=>JSON.stringify(Object.hasOwn(e,"get")&&e.get())).join(""),M=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();var x=t=>{let e="",r=!1,i={},o=s=>{},d=()=>{let s=document.querySelector(`[data-nice-id="${e}"]`);!s||r||(r=!0,setTimeout(()=>{let n=o(e);n&&s.replaceWith(n.children[0]),r=!1},0))};return(s,n)=>(e=N(),R(e),i=s??{},o=t(i,n),{id:e,type:"component",properties:s,render:o,markDirty:d,key:n??e})};var j=(t,e)=>{let r=x(t)();if(e&&typeof window<"u"){let i=e?document.querySelector(e):void 0;if(!i)throw new Error(`Failed to attach - Element "${e}" not found in the DOM.`);r.markDirty=()=>{let o=r.render(N());if(o){for(;i.firstChild;)i.removeChild(i.firstChild);window?Array.from(o.hydrate().children).forEach(d=>{i.appendChild(d)}):i.innerHTML=o.html}},r.markDirty()}else return{html:r.render("nice-app-root").html,id:"nice-app-root",hydrate:i=>{let o=document.querySelector(`#${i}`);if(!o)throw new Error(`Failed to attach - Element "${e}" not found in the DOM.`);r.markDirty=()=>{let d=r.render(N());if(d){for(;o.firstChild;)o.removeChild(o.firstChild);window?Array.from(d.hydrate().children).forEach(m=>{o.appendChild(m)}):o.innerHTML=d.html}},r.markDirty()}}};var $=(t,...e)=>o=>{let d=`<!-- ${o} BEGIN -->`,m=`<!-- ${o} END -->`,s="",n={},a={};t.forEach((l,f)=>{let p=e[f];if(s+=l,p===void 0)return;let u=L(l),c=Math.random().toString(36).substring(7);if(typeof p!="object"){u&&!l.endsWith('"')?s+=`"${p}"`:s+=p;return}switch(p.type){case"component":s+=c,n[c]=p.render(p.id);break;case"state":s+=c,a[c]=p;break}}),Object.keys(n).forEach(l=>{s=s.replace(l,n[l].html.replace(/(<.+)( )/,`$1 data-reattach-child="${l}" `))}),Object.keys(a).forEach(l=>{let f=s.split(l)[0],p=L(f),u=a[l].get(),c=u,g=1;if(u)if(typeof u=="object"&&u.type==="component"){let T=u;c=T.render(T.id).html}else Array.isArray(u)&&(g=u.length,c=u.map(T=>{if(typeof T=="object"&&T.type==="component"){let C=T;return C.render(C.id).html}else return T}).join(""));let E=p?`"${c||""}" data-bind-${p}="${l}"`:`<!-- @ -->${c}<span style="display: none;" data-reattach-state="${l}" data-reattach-extras="${!!c&&g}"></span><!-- # -->`;s=s.replace(l,E)});let y=()=>{let l=z(s);return l.children[0].setAttribute("data-nice-id",o),Object.keys(a).forEach(f=>{l.querySelectorAll(`[data-reattach-state="${f}"]`).forEach(p=>{let u=p.getAttribute("data-reattach-extras");if(u&&u!=="false")for(let g=0;g<parseInt(u);g++)p.previousSibling?.remove();let c=a[f].get();a[f].markers.push([p.previousSibling,p.nextSibling]),S(c,p.previousSibling,p.nextSibling)})}),Object.keys(n).forEach(f=>{l.querySelectorAll(`[data-reattach-child="${f}"]`).forEach(p=>{p.replaceWith(n[f].hydrate().children[0])})}),l.querySelectorAll("*").forEach(f=>{Array.from(f.attributes).forEach(p=>{let u=p.name.match(/data-bind-(.+)$/);if(u){let c=u[1].trim(),g=p.value,E=c.startsWith("on-"),T=c.startsWith("set-"),C=c==="ref",h=a[g];if(!h)return;h.attributes[c]||(h.attributes[c]=[]),E?(f.removeAttribute(c),f.addEventListener(c.slice(3),k=>h.set(k))):T?(f.removeAttribute(c),h.listen(k=>{f[c.slice(4)]=k}),f[c.slice(4)]=h.get()):C?(f.removeAttribute(c),h.set(f)):(h.attributes[c].push(f),f.setAttribute(c,h.get()??"")),f.removeAttribute(p.name)}})}),l};return{html:s.trim(),hydrate:y}},S=(t,e,r)=>{let i=[],o=e.nextSibling;for(;o!==r;)i.push(o),o=o?.nextSibling;if(t&&typeof t=="object"&&t.type==="component"){let d=t,m=d.render(d.id);i.forEach(s=>s.remove()),m&&Array.from(m.hydrate().children).reverse().forEach(s=>e.after(s))}else{let d=Array.isArray(t)?t:[t],m=d.map(n=>{if(typeof n=="object"&&n.type==="component"){let a=n;return a.key??a.id}else return}).filter(n=>n!==void 0),s=d.map(n=>{if(typeof n=="object"&&n.type==="component"){console.log("RendernChild",n,n.properties);let a=n,y=a.render(a.id).hydrate();return y.children[0]&&n.key&&y.children[0].setAttribute("data-nice-key",n.key),console.log(y.children[0]),y}else return n});m.length?(i.forEach(n=>{m.includes(n.getAttribute("data-nice-key"))||n.remove()}),s.reverse().forEach(n=>{if(n instanceof HTMLElement){let a=null;Array.from(n.children).reverse().forEach(y=>{e.parentElement?.querySelector(`[data-nice-key="${y.getAttribute("data-nice-key")}"]`)||(a??r).before(y),a=y})}else{let a=document.createTextNode(n);e.after(a)}})):(i.forEach(n=>n.remove()),s.reverse().forEach(n=>{if(n instanceof HTMLElement)Array.from(n.children).reverse().forEach(a=>e.after(a));else{let a=document.createTextNode(n);e.after(a)}}))}},z=t=>{let e=document.createElement("div");return e.innerHTML=t,e},L=t=>{let e=/.+ (.+)="?$/gm,r,i=[];for(;(r=e.exec(t))!==null;)r.index===e.lastIndex&&e.lastIndex++,r.forEach(o=>{i.push(o)});if(i.length===2)return i[1]};var b=t=>{let e=t,r=N(),i=[],o=[],d=[],m={};return{id:r,type:"state",get:()=>e,set:s=>{let n=e;typeof t=="function"?n=s(e):n=s,n!==e&&(e=n,i.forEach(a=>a(n)),Object.entries(m).forEach(([a,y])=>{y.forEach(l=>{l.setAttribute(a,n??"")})}),d.forEach(([a,y])=>{S(e,a,y)}))},listen:s=>i.push(s),textNodes:o,markers:d,attributes:m}},A=(t,e)=>{let r=b(void 0),i=void 0,o=(e??[]).map(m=>m&&typeof m=="object"&&Object.hasOwn(m,"listen")?m:!1).filter(Boolean),d=m=>{let s=!!m&&!e,n=t(m),a=I(o);n!==r.get()&&a!==i&&!s&&r.set(n)};return e?(o.forEach(m=>m.listen(d)),d()):r.listen(d),r},D=t=>A(t||(()=>{}));var O=t=>{let e=Object.entries(t).reduce((r,[i,o])=>(r[i]=b(o),r),{});return r=>e[r]};var U=(t,e)=>{let r=[];typeof t=="number"?r=Array.from({length:t},(d,m)=>m+1):Array.isArray(t)?r=[...t]:typeof t=="object"&&(r=Array.from(Object.entries(t)));let i=!1,o=r.map((d,m)=>{let s=e(d,m);return typeof s=="function"?(i=v,x(()=>s)()):s});return i?o.reverse():o},H=t=>typeof t=="object"&&Object.hasOwn(t,"get")?t.get():t,P=t=>Object.entries(t).reduce((e,[r,i])=>`${e}${M(r)}: ${i};`,"");var G=b,J=A,Z=$,Q=x,X=D,Y=O,ee=H,v=typeof window<"u";
