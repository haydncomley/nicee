"use strict";var g=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var U=(e,t)=>{for(var n in t)g(e,n,{get:t[n],enumerable:!0})},L=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of D(t))!P.call(e,o)&&o!==n&&g(e,o,{get:()=>t[o],enumerable:!(s=j(t,o))||s.enumerable});return e};var H=e=>L(g({},"__esModule",{value:!0}),e);var K={};U(K,{app:()=>k,component:()=>_,computed:()=>q,mapper:()=>I,ref:()=>G,render:()=>W,state:()=>B,store:()=>J,valueOf:()=>z});module.exports=H(K);var y=()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=e.length;for(let s=0;s<10;s++)t+=e.charAt(Math.floor(Math.random()*n));return t},$=y(),S=e=>{$=e};var v=e=>e.map(t=>JSON.stringify(Object.hasOwn(t,"get")&&t.get())).join("");var h=e=>{let t="",n=!1,s={},o=r=>{},p=()=>{let r=document.querySelector(`[data-nice-id="${t}"]`);!r||n||(n=!0,setTimeout(()=>{let c=o(t);c&&r.replaceWith(c.children[0]),n=!1},0))};return r=>(t=y(),S(t),s=r??{},o=e(s),{id:t,type:"component",properties:r,render:o,markDirty:p})};var k=(e,t)=>{let n=document.querySelector(e);if(!n)throw new Error(`Failed to attach - Element "${e}" not found in the DOM.`);let s=h(t)();s.markDirty=()=>{let o=s.render(y());if(o){for(;n.firstChild;)n.removeChild(n.firstChild);Array.from(o.children).forEach(p=>{n.appendChild(p)})}},s.markDirty()};var R=(e,...t)=>o=>{let p=`<!-- ${o} BEGIN -->`,m=`<!-- ${o} END -->`,r="",c={},d={};e.forEach((i,a)=>{let f=t[a];if(r+=i,f===void 0)return;let T=Math.random().toString(36).substring(7);switch(f.type){case"component":r+=T,c[T]=f.render(f.id);break;case"state":r+=T,d[T]=f;break}}),Object.keys(c).forEach(i=>{r=r.replace(i,`<span data-reattach-child="${i}"></span>`)}),Object.keys(d).forEach(i=>{let a=r.split(i)[0],T=V(a)?`state-${i}`:`<!-- @ --><span data-reattach-state="${i}"></span><!-- # -->`;r=r.replace(i,T)});let l=F(r);return l.children[0].setAttribute("data-nice-id",o),Object.keys(d).forEach(i=>{l.querySelectorAll(`[data-reattach-state="${i}"]`).forEach(a=>{let f=d[i].get();d[i].markers.push([a.previousSibling,a.nextSibling]),b(f,a.previousSibling,a.nextSibling)})}),Object.keys(c).forEach(i=>{l.querySelectorAll(`[data-reattach-child="${i}"]`).forEach(a=>{a.replaceWith(c[i].children[0])})}),l.querySelectorAll("*").forEach(i=>{Array.from(i.attributes).forEach(a=>{let f=a.name.startsWith("on-"),T=a.name.startsWith("set-"),M=a.name==="ref",C=a.value.match(/state-(.+)/);if(C){let u=d[C[1]];if(!u)return;u.attributes[a.name]||(u.attributes[a.name]=[]),f?(i.removeAttribute(a.name),i.addEventListener(a.name.slice(3),x=>u.set(x))):T?(i.removeAttribute(a.name),u.listen(x=>{i[a.name.slice(4)]=x}),i[a.name.slice(4)]=u.get()):M?(i.removeAttribute(a.name),u.set(i)):(u.attributes[a.name].push(i),i.setAttribute(a.name,u.get()??""))}})}),l},b=(e,t,n)=>{let s=[],o=t.nextSibling;for(;o!==n;)s.push(o),o=o?.nextSibling;if(e&&typeof e=="object"&&e.type==="component"){let p=e,m=p.render(p.id);s.forEach(r=>r.remove()),m&&Array.from(m.children).reverse().forEach(r=>t.after(r))}else{let m=(Array.isArray(e)?e:[e]).map(r=>{if(typeof r=="object"&&r.type==="component"){let c=r;return c.render(c.id)}else return r});s.forEach(r=>r.remove()),m.reverse().forEach(r=>{if(r instanceof HTMLElement)Array.from(r.children).reverse().forEach(c=>t.after(c));else{let c=document.createTextNode(r);t.after(c)}})}},F=e=>{let t=document.createElement("div");return t.innerHTML=e,t},V=e=>{let t=/.+\b(.+)="?$/gm,n,s=[];for(;(n=t.exec(e))!==null;)n.index===t.lastIndex&&t.lastIndex++,n.forEach(o=>{s.push(o)});if(s.length===2)return s[1]};var N=e=>{let t=e,n=y(),s=[],o=[],p=[],m={};return{id:n,type:"state",get:()=>t,set:r=>{let c=t;typeof e=="function"?c=r(t):c=r,c!==t&&(t=c,s.forEach(d=>d(c)),Object.entries(m).forEach(([d,l])=>{l.forEach(i=>{i.setAttribute(d,c??"")})}),p.forEach(([d,l])=>{b(t,d,l)}))},listen:r=>s.push(r),textNodes:o,markers:p,attributes:m}},E=(e,t)=>{let n=N(void 0),s=void 0,o=(t??[]).map(m=>m&&typeof m=="object"&&Object.hasOwn(m,"listen")?m:!1).filter(Boolean),p=m=>{let r=!!m&&!t,c=e(m),d=v(o);c!==n.get()&&d!==s&&!r&&n.set(c)};return t?(o.forEach(m=>m.listen(p)),p()):n.listen(p),n},w=e=>E(e||(()=>{}));var A=e=>{let t=Object.entries(e).reduce((n,[s,o])=>(n[s]=N(o),n),{});return[n=>t[n]]};var I=(e,t)=>{let n=[];return typeof e=="number"?n=Array.from({length:e},(s,o)=>o+1):typeof e=="object"?n=Array.from(Object.entries(e)):Array.isArray(e)&&(n=e),n.map((s,o)=>t(s,o))},O=e=>typeof e=="object"&&Object.hasOwn(e,"get")?e.get():e;var B=N,q=E,W=R,_=h,G=w,J=A,z=O;
